<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    
    <title>TL;DR Electronics</title>
</head>

<body>
    <!-- Header -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="/">
                    <h2 class="mb-0">TL;DR Electronics</h2>
                </a>
                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="/">Home</a>
                        </li>
                    </ul>
                    
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://github.com/TLDR-Electronics/" target="_blank" rel="noopener noreferrer" aria-label="GitHub repository">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24" width="24.25" viewBox="0 0 496 512" fill="currentColor">
                                    <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1.3 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1.3zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>
                                </svg>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <!-- ./ Header -->

    <!-- Main -->
    <main class="container mt-4">
        
<style>
  .main-container {
    display: flex;
    height: calc(100vh - 120px); /* Account for navbar and some padding */
    gap: 1rem;
  }

  .left-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-width: 0; /* Allow flex shrinking */
  }

  #cy {
    flex: 1;
    background: #ecf0f1;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
  }

  .right-panel {
    width: 320px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    max-height: 100%;
  }

  .properties-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
  }

  .no-selection {
    color: #6c757d;
    font-style: italic;
    text-align: center;
    margin-top: 2rem;
  }

  .property-form {
    display: none;
  }

  .property-form.active {
    display: block;
  }

  .regulator-options {
    margin-top: 10px;
    padding: 10px;
    border-radius: 4px;
    display: none;
  }

  .regulator-options.active {
    display: block;
  }

  .connection-hint {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 10px;
    border-radius: 5px;
    font-size: 12px;
    z-index: 1000;
    display: none;
  }

  .connection-hint.active {
    display: block;
  }

  .context-menu {
    position: fixed;
    background: var(--bs-body-bg);
    border: 1px solid var(--bs-border-color);
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    min-width: 120px;
    display: none;
  }

  .context-menu-item {
    padding: 8px 12px;
    cursor: pointer;
    border-bottom: 1px solid var(--bs-border-color);
    font-size: 14px;
    color: var(--bs-body-color);
  }

  .context-menu-item:last-child {
    border-bottom: none;
  }

  .context-menu-item:hover {
    background: var(--bs-secondary-bg);
  }

  .context-menu-item.danger:hover {
    background: var(--bs-danger-bg-subtle);
    color: var(--bs-danger-text-emphasis);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .main-container {
      flex-direction: column;
      height: auto;
    }
    
    .right-panel {
      width: 100%;
      max-height: 400px;
    }
    
    #cy {
      height: 400px;
    }
  }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.33.1/cytoscape.umd.js"></script>

<div class="container-fluid">
<h2>Power Analyser (Beta)</h2>
  <!-- Control Panel -->
  <div class="row mb-3">
    <div class="col-12">
      <div class="card">
        <div class="card-body p-2">
          <div class="d-flex gap-2 flex-wrap">
            <button class="btn btn-primary btn-sm" id="add-node-btn">Add Node</button>
            <button class="btn btn-primary btn-sm" id="connect-mode-btn">Connect Mode</button>
            <button class="btn btn-primary btn-sm" id="delete-mode-btn">Delete Mode</button>
            <button class="btn btn-secondary btn-sm" id="clear-btn">Clear All</button>
            <button class="btn btn-info btn-sm" id="layout-btn">Auto Layout</button>
            <button class="btn btn-success btn-sm" id="save-url-btn">Save to URL</button>
            <button class="btn btn-success btn-sm" id="copy-url-btn">Copy URL</button>
            <button class="btn btn-warning btn-sm" id="load-url-btn">Load from URL</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Status Bar -->
  <div class="row mb-3">
    <div class="col-12">
      <div class="alert alert-info mb-0" role="alert">
        <small id="status-text">Ready - Click a mode button to get started</small>
      </div>
    </div>
  </div>

  <!-- Main Interface -->
  <div class="main-container">
    <div class="left-panel">
      <div id="cy"></div>
    </div>

    <div class="right-panel">
      <div class="card h-100">
        <div class="card-header">
          <h6 class="mb-0">Component Properties</h6>
        </div>
        <div class="properties-content">
          <div class="no-selection" id="no-selection">
            Click on a component to edit its properties
          </div>

          <div class="property-form" id="property-form">
            <div class="alert alert-info" id="component-info">
              <small>
                <strong>Component ID:</strong> <span id="info-id"></span><br>
                <strong>Type:</strong> <span id="info-type"></span>
              </small>
            </div>

            <div class="mb-3">
              <label for="prop-name" class="form-label fw-bold">Name:</label>
              <input type="text" class="form-control form-control-sm" id="prop-name" placeholder="Component name">
            </div>

            <div class="mb-3">
              <label class="form-label fw-bold">Category:</label>
              <div class="d-flex gap-3 mt-2">
                <div class="form-check">
                  <input class="form-check-input" type="radio" id="categoryChoice1" name="category" value="supply">
                  <label class="form-check-label" for="categoryChoice1">Supply</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" id="categoryChoice2" name="category" value="load">
                  <label class="form-check-label" for="categoryChoice2">Load</label>
                </div>
              </div>
            </div>

            <div class="mb-3" id="supply-options">
              <label for="prop-voltage" class="form-label fw-bold">Output Voltage (V):</label>
              <input type="number" class="form-control form-control-sm" id="prop-voltage" placeholder="Enter voltage" step="0.1">

              <div class="regulator-options bg-body-secondary" id="regulator-options">
                <label class="form-label fw-bold">Regulator Type:</label>
                <div class="d-flex gap-3 mt-2">
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="regulatorLinear" name="regulator_type" value="linear">
                    <label class="form-check-label" for="regulatorLinear">Linear</label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="regulatorSwitching" name="regulator_type" value="switching">
                    <label class="form-check-label" for="regulatorSwitching">Switching</label>
                  </div>
                </div>
                
                <div class="mt-3">
                  <label for="prop-efficiency" class="form-label fw-bold">Efficiency (%):</label>
                  <input type="number" class="form-control form-control-sm" id="prop-efficiency" placeholder="Enter efficiency" min="1" max="100" step="1">
                </div>
              </div>
            </div>

            <div class="mb-3" id="load-options">
              <label for="prop-load" class="form-label fw-bold">Load Value (Ω):</label>
              <input type="number" class="form-control form-control-sm" id="prop-load" placeholder="Enter resistance" step="0.1" min="0.1">
            </div>

            <div class="mt-4 pt-3 border-top">
              <button class="btn btn-primary btn-sm me-2" id="apply-changes">Apply Changes</button>
              <button class="btn btn-secondary btn-sm" id="clear-selection">Clear Selection</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Instructions Section -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0">Instructions</h6>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <h6>Basic Operations:</h6>
              <ul class="small">
                <li><strong>Add Node:</strong> Click "Add Node" then click anywhere on the canvas</li>
                <li><strong>Connect Mode:</strong> Click "Connect Mode", then click two nodes to connect them</li>
                <li><strong>Delete Mode:</strong> Click "Delete Mode", then click nodes or edges to delete them</li>
                <li><strong>Edit Properties:</strong> Click any node to edit its properties in the right panel</li>
              </ul>
            </div>
            <div class="col-md-6">
              <h6>Connection Rules:</h6>
              <ul class="small">
                <li><strong>Supplies → Loads:</strong> Allowed</li>
                <li><strong>Supplies → Supplies:</strong> Allowed (cascaded regulators)</li>
                <li><strong>Loads → Loads:</strong> Not allowed</li>
                <li><strong>Normal Mode:</strong> Click any mode button again to return to normal (drag nodes around)</li>
                <li><strong>Right-click:</strong> Right-click any node or connection for quick actions</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="context-menu" id="context-menu">
  <div class="context-menu-item" id="context-edit">Edit Properties</div>
  <div class="context-menu-item danger" id="context-delete">Delete</div>
</div>

<div class="card">
    <div class="card-body">
        <div class="accordion" id="disclaimerAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#disclaimerCollapse" aria-expanded="false" aria-controls="disclaimerCollapse">
                        Disclaimer
                    </button>
                </h2>
                <div id="disclaimerCollapse" class="accordion-collapse collapse" data-bs-parent="#disclaimerAccordion">
                    <div class="accordion-body">
                        <p>This calculator is intended for reference only. While efforts have been made to ensure the accuracy of calculations, no warranty is provided. Users must independently verify results before applying them in design, testing, or production. This tool is not intended for safety-critical or certified applications. Use at your own risk.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="component.js"></script>
<script src="power_analyser.js"></script>

    </div>
    </main>
    <!-- ./ Main -->

    <!-- Bootstrap JS Bundle -->
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
</body>

</html>